"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const react_1 = require("react");
const config_service_1 = require("../services/config.service");
const react_2 = __importDefault(require("@monaco-editor/react"));
const Config = ({ onClose }) => {
    const [configJson, setConfigJson] = (0, react_1.useState)('');
    const [isEditing, setIsEditing] = (0, react_1.useState)(false);
    const [isLoading, setIsLoading] = (0, react_1.useState)(true);
    const [isSubmitting, setIsSubmitting] = (0, react_1.useState)(false);
    const [showRoutingHelp, setShowRoutingHelp] = (0, react_1.useState)(false);
    const [notification, setNotification] = (0, react_1.useState)(null);
    (0, react_1.useEffect)(() => {
        const fetchConfig = async () => {
            try {
                const data = await (0, config_service_1.getConfig)();
                setConfigJson(JSON.stringify(data, null, 2));
            }
            catch (err) {
                setNotification({
                    type: 'error',
                    message: 'Failed to fetch config',
                });
            }
            finally {
                setIsLoading(false);
            }
        };
        fetchConfig();
    }, []);
    (0, react_1.useEffect)(() => {
        if (notification) {
            const timer = setTimeout(() => {
                setNotification(null);
            }, 3000);
            return () => clearTimeout(timer);
        }
    }, [notification]);
    const handleSubmit = async () => {
        setIsEditing(false);
        setIsSubmitting(true);
        setNotification(null);
        try {
            await (0, config_service_1.submitConfig)(configJson);
            setNotification({
                type: 'success',
                message: 'Config updated successfully',
            });
        }
        catch (err) {
            setNotification({
                type: 'error',
                message: 'Failed to update config',
            });
        }
        finally {
            setIsSubmitting(false);
        }
    };
    return (<div className="config-container">
        <h2>Manage Configuration Object</h2>
        {notification && (<div className={`notification ${notification.type}`}>
            {notification.message}
            </div>)}
        <div className="mb-4">
            <button onClick={() => setShowRoutingHelp(!showRoutingHelp)} className="text-blue-600 hover:underline focus:outline-none">
                {showRoutingHelp ? 'Hide' : 'Show'} Routing Options Help
            </button>
            {showRoutingHelp && (<div className="mt-2 p-4 bg-gray-100 rounded text-sm whitespace-pre-wrap">
                <strong>Routing Options:</strong>
                <br />
                • <code>enableFallbacks</code>: boolean — enable global fallback
                <br />
                • <code>fallbackModel</code>: {`{ provider, model }`} — default fallback
                <br />
                • <code>fallbackOnStatus</code>: number[] — status codes to trigger fallback
                <br />
                • <code>retries</code>: number — number of retry attempts
                <br />
                • <code>availableMetadata</code>: string[] — allowed metadata keys
                <br />
                • <code>conditions</code>: condition[] — routing rules by metadata
                <br />
                &nbsp;&nbsp;&nbsp;↳ <code>name</code>: string — condition name
                <br />
                &nbsp;&nbsp;&nbsp;↳ <code>query</code>: function — metadata predicate
                <br />
                &nbsp;&nbsp;&nbsp;↳ <code>loadBalance</code>: model[] — weighted models
                <br />
                &nbsp;&nbsp;&nbsp;↳ <code>fallbackModel</code>: optional fallback
                <br />
                • <code>defaultModel</code>: {`{ provider, model }`} — fallback if no match
                </div>)}
        </div>

        {(isLoading || isSubmitting) && (<div className="modal-loading-overlay">
            <div className="spinner"></div>
            </div>)}
        {(isEditing ? (<react_2.default height="50vh" defaultLanguage="json" defaultValue={configJson} onChange={(value) => setConfigJson(value || '')}/>) : (<pre>{configJson}</pre>))}
        <div className="config-object"></div>
        <div className="mt-4 flex justify-between">
          <button onClick={onClose} className="px-4 py-2 bg-gray-200 rounded">Close</button>
          {isEditing && !isSubmitting ? (<div className="space-x-2">
              <button onClick={() => setIsEditing(false)} className="px-4 py-2 bg-gray-300 rounded">Cancel</button>
              <button onClick={handleSubmit} className="px-4 py-2 bg-blue-600 text-white rounded">Submit</button>
            </div>) : (<button onClick={() => setIsEditing(true)} className="px-4 py-2 bg-blue-600 text-white rounded">Edit</button>)}
        </div>
        </div>);
};
exports.default = Config;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ29uZmlnLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vZnJvbnRlbmQtdWkvc3JjL2NvbXBvbmVudHMvQ29uZmlnLnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLGlDQUE0QztBQUM1QywrREFHb0M7QUFDcEMsaUVBQTBDO0FBTTFDLE1BQU0sTUFBTSxHQUFHLENBQUMsRUFBRSxPQUFPLEVBQWUsRUFBRSxFQUFFO0lBQ3hDLE1BQU0sQ0FBQyxVQUFVLEVBQUUsYUFBYSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFTLEVBQUUsQ0FBQyxDQUFDO0lBQ3pELE1BQU0sQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2xELE1BQU0sQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2pELE1BQU0sQ0FBQyxZQUFZLEVBQUUsZUFBZSxDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3hELE1BQU0sQ0FBQyxlQUFlLEVBQUUsa0JBQWtCLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFDOUQsTUFBTSxDQUFDLFlBQVksRUFBRSxlQUFlLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBR3RDLElBQUksQ0FBQyxDQUFDO0lBRWhCLElBQUEsaUJBQVMsRUFBQyxHQUFHLEVBQUU7UUFDWCxNQUFNLFdBQVcsR0FBRyxLQUFLLElBQUksRUFBRTtZQUMvQixJQUFJLENBQUM7Z0JBQ0QsTUFBTSxJQUFJLEdBQUcsTUFBTSxJQUFBLDBCQUFTLEdBQUUsQ0FBQztnQkFDL0IsYUFBYSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ2pELENBQUM7WUFBQyxPQUFPLEdBQUcsRUFB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Q0FBQztBQUNOLENBQUMsQ0FBQztBQUVGLGtCQUFlLE1BQU0sQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQge1xuICAgIGdldENvbmZpZyxcbiAgICBzdWJtaXRDb25maWcsXG59IGZyb20gJy4uL3NlcnZpY2VzL2NvbmZpZy5zZXJ2aWNlJztcbmltcG9ydCBFZGl0b3IgZnJvbSAnQG1vbmFjby1lZGl0b3IvcmVhY3QnO1xuXG5pbnRlcmZhY2UgQ29uZmlnUHJvcHMge1xuICBvbkNsb3NlOiAoKSA9PiB2b2lkO1xufVxuXG5jb25zdCBDb25maWcgPSAoeyBvbkNsb3NlIH06IENvbmZpZ1Byb3BzKSA9PiB7XG4gICAgY29uc3QgW2NvbmZpZ0pzb24sIHNldENvbmZpZ0pzb25dID0gdXNlU3RhdGU8c3RyaW5nPignJyk7XG4gICAgY29uc3QgW2lzRWRpdGluZywgc2V0SXNFZGl0aW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUodHJ1ZSk7XG4gICAgY29uc3QgW2lzU3VibWl0dGluZywgc2V0SXNTdWJtaXR0aW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgICBjb25zdCBbc2hvd1JvdXRpbmdIZWxwLCBzZXRTaG93Um91dGluZ0hlbHBdID0gdXNlU3RhdGUoZmFsc2UpO1xuICAgIGNvbnN0IFtub3RpZmljYXRpb24sIHNldE5vdGlmaWNhdGlvbl0gPSB1c2VTdGF0ZTx7XG4gICAgICAgIHR5cGU6ICdzdWNjZXNzJyB8ICdlcnJvcic7XG4gICAgICAgIG1lc3NhZ2U6IHN0cmluZztcbiAgICB9IHwgbnVsbD4obnVsbCk7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBjb25zdCBmZXRjaENvbmZpZyA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBnZXRDb25maWcoKTtcbiAgICAgICAgICAgIHNldENvbmZpZ0pzb24oSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMikpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHNldE5vdGlmaWNhdGlvbih7XG4gICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBmZXRjaCBjb25maWcnLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgZmV0Y2hDb25maWcoKTtcbiAgICB9LCBbXSk7XG5cbiAgICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgICAgICBpZiAobm90aWZpY2F0aW9uKSB7XG4gICAgICAgIGNvbnN0IHRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBzZXROb3RpZmljYXRpb24obnVsbCk7XG4gICAgICAgIH0sIDMwMDApO1xuICAgICAgICByZXR1cm4gKCkgPT4gY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgICAgfVxuICAgIH0sIFtub3RpZmljYXRpb25dKTtcblxuICAgIGNvbnN0IGhhbmRsZVN1Ym1pdCA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgc2V0SXNFZGl0aW5nKGZhbHNlKTtcbiAgICAgICAgc2V0SXNTdWJtaXR0aW5nKHRydWUpO1xuICAgICAgICBzZXROb3RpZmljYXRpb24obnVsbCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBzdWJtaXRDb25maWcoY29uZmlnSnNvbik7XG4gICAgICAgICAgICBzZXROb3RpZmljYXRpb24oe1xuICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJyxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQ29uZmlnIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5JyxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIHNldE5vdGlmaWNhdGlvbih7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnRmFpbGVkIHRvIHVwZGF0ZSBjb25maWcnLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICBzZXRJc1N1Ym1pdHRpbmcoZmFsc2UpO1xuXG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcmV0dXJuIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb25maWctY29udGFpbmVyXCI+XG4gICAgICAgIDxoMj5NYW5hZ2UgQ29uZmlndXJhdGlvbiBPYmplY3Q8L2gyPlxuICAgICAgICB7bm90aWZpY2F0aW9uICYmIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtgbm90aWZpY2F0aW9uICR7bm90aWZpY2F0aW9uLnR5cGV9YH0+XG4gICAgICAgICAgICB7bm90aWZpY2F0aW9uLm1lc3NhZ2V9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKX1cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtYi00XCI+XG4gICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0U2hvd1JvdXRpbmdIZWxwKCFzaG93Um91dGluZ0hlbHApfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInRleHQtYmx1ZS02MDAgaG92ZXI6dW5kZXJsaW5lIGZvY3VzOm91dGxpbmUtbm9uZVwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge3Nob3dSb3V0aW5nSGVscCA/ICdIaWRlJyA6ICdTaG93J30gUm91dGluZyBPcHRpb25zIEhlbHBcbiAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICAgICAge3Nob3dSb3V0aW5nSGVscCAmJiAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJtdC0yIHAtNCBiZy1ncmF5LTEwMCByb3VuZGVkIHRleHQtc20gd2hpdGVzcGFjZS1wcmUtd3JhcFwiPlxuICAgICAgICAgICAgICAgIDxzdHJvbmc+Um91dGluZyBPcHRpb25zOjwvc3Ryb25nPlxuICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgICAgIOKAoiA8Y29kZT5lbmFibGVGYWxsYmFja3M8L2NvZGU+OiBib29sZWFuIOKAlCBlbmFibGUgZ2xvYmFsIGZhbGxiYWNrXG4gICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgICAg4oCiIDxjb2RlPmZhbGxiYWNrTW9kZWw8L2NvZGU+OiB7YHsgcHJvdmlkZXIsIG1vZGVsIH1gfSDigJQgZGVmYXVsdCBmYWxsYmFja1xuICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgICAgIOKAoiA8Y29kZT5mYWxsYmFja09uU3RhdHVzPC9jb2RlPjogbnVtYmVyW10g4oCUIHN0YXR1cyBjb2RlcyB0byB0cmlnZ2VyIGZhbGxiYWNrXG4gICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgICAg4oCiIDxjb2RlPnJldHJpZXM8L2NvZGU+OiBudW1iZXIg4oCUIG51bWJlciBvZiByZXRyeSBhdHRlbXB0c1xuICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgICAgIOKAoiA8Y29kZT5hdmFpbGFibGVNZXRhZGF0YTwvY29kZT46IHN0cmluZ1tdIOKAlCBhbGxvd2VkIG1ldGFkYXRhIGtleXNcbiAgICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgICDigKIgPGNvZGU+Y29uZGl0aW9uczwvY29kZT46IGNvbmRpdGlvbltdIOKAlCByb3V0aW5nIHJ1bGVzIGJ5IG1ldGFkYXRhXG4gICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A74oazIDxjb2RlPm5hbWU8L2NvZGU+OiBzdHJpbmcg4oCUIGNvbmRpdGlvbiBuYW1lXG4gICAgICAgICAgICAgICAgPGJyIC8+XG4gICAgICAgICAgICAgICAgJm5ic3A7Jm5ic3A7Jm5ic3A74oazIDxjb2RlPnF1ZXJ5PC9jb2RlPjogZnVuY3Rpb24g4oCUIG1ldGFkYXRhIHByZWRpY2F0ZVxuICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwO+KGsyA8Y29kZT5sb2FkQmFsYW5jZTwvY29kZT46IG1vZGVsW10g4oCUIHdlaWdodGVkIG1vZGVsc1xuICAgICAgICAgICAgICAgIDxiciAvPlxuICAgICAgICAgICAgICAgICZuYnNwOyZuYnNwOyZuYnNwO+KGsyA8Y29kZT5mYWxsYmFja01vZGVsPC9jb2RlPjogb3B0aW9uYWwgZmFsbGJhY2tcbiAgICAgICAgICAgICAgICA8YnIgLz5cbiAgICAgICAgICAgICAgICDigKIgPGNvZGU+ZGVmYXVsdE1vZGVsPC9jb2RlPjoge2B7IHByb3ZpZGVyLCBtb2RlbCB9YH0g4oCUIGZhbGxiYWNrIGlmIG5vIG1hdGNoXG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICB7KGlzTG9hZGluZyB8fCBpc1N1Ym1pdHRpbmcpICYmIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibW9kYWwtbG9hZGluZy1vdmVybGF5XCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInNwaW5uZXJcIj48L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApfVxuICAgICAgICB7KGlzRWRpdGluZyA/IChcbiAgICAgICAgICAgIDxFZGl0b3JcbiAgICAgICAgICAgIGhlaWdodD1cIjUwdmhcIlxuICAgICAgICAgICAgZGVmYXVsdExhbmd1YWdlPVwianNvblwiXG4gICAgICAgICAgICBkZWZhdWx0VmFsdWU9e2NvbmZpZ0pzb259XG4gICAgICAgICAgICBvbkNoYW5nZT17KHZhbHVlKSA9PiBzZXRDb25maWdKc29uKHZhbHVlIHx8ICcnKX1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICkgOiAoXG4gICAgICAgICAgICA8cHJlPntjb25maWdKc29ufTwvcHJlPlxuICAgICAgICApKX1cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb25maWctb2JqZWN0XCI+PC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtNCBmbGV4IGp1c3RpZnktYmV0d2VlblwiPlxuICAgICAgICAgIDxidXR0b24gb25DbGljaz17b25DbG9zZX0gY2xhc3NOYW1lPVwicHgtNCBweS0yIGJnLWdyYXktMjAwIHJvdW5kZWRcIj5DbG9zZTwvYnV0dG9uPlxuICAgICAgICAgIHtpc0VkaXRpbmcgJiYgIWlzU3VibWl0dGluZyA/IChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwic3BhY2UteC0yXCI+XG4gICAgICAgICAgICAgIDxidXR0b24gb25DbGljaz17KCkgPT4gc2V0SXNFZGl0aW5nKGZhbHNlKX0gY2xhc3NOYW1lPVwicHgtNCBweS0yIGJnLWdyYXktMzAwIHJvdW5kZWRcIj5DYW5jZWw8L2J1dHRvbj5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBvbkNsaWNrPXtoYW5kbGVTdWJtaXR9IGNsYXNzTmFtZT1cInB4LTQgcHktMiBiZy1ibHVlLTYwMCB0ZXh0LXdoaXRlIHJvdW5kZWRcIj5TdWJtaXQ8L2J1dHRvbj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICA8YnV0dG9uIG9uQ2xpY2s9eygpID0+IHNldElzRWRpdGluZyh0cnVlKX0gY2xhc3NOYW1lPVwicHgtNCBweS0yIGJnLWJsdWUtNjAwIHRleHQtd2hpdGUgcm91bmRlZFwiPkVkaXQ8L2J1dHRvbj5cbiAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IENvbmZpZztcbiJdfQ==